webpackJsonp([37],{"+4gK":function(e,t,i){"use strict";var o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container calendar-list-container",style:{height:e.$store.state.app.client.height+"px"}},[i("el-row",{attrs:{gutter:5}},[i("el-col",{staticClass:"org-tree-left"},[i("el-card",[i("el-row",[i("span",{staticStyle:{"font-size":"16px","font-weight":"600","font-family":"'微软雅黑 Light'"}},[e._v("部门筛选")]),e._v(" "),i("el-col",[i("hr",{staticStyle:{border:"none","border-bottom":"1px solid #d3dce6"}})])],1),e._v(" "),i("my-tree",{attrs:{url:"/upms/org/tree"},on:{node:e.getList},model:{value:e.listQuery.orgId,callback:function(t){e.$set(e.listQuery,"orgId",t)},expression:"listQuery.orgId"}})],1)],1),e._v(" "),i("el-col",{style:{width:e.$store.state.app.client.width-225+"px"}},[i("el-card",[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"职位名字"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchClick(t)}},model:{value:e.listQuery.roleName,callback:function(t){e.$set(e.listQuery,"roleName",t)},expression:"listQuery.roleName"}}),e._v(" "),i("el-button",{staticClass:"filter-item",staticStyle:{"margin-bottom":"15px"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.getList}},[e._v("搜索")]),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{height:e.$store.state.app.client.height-215,data:e.list,"element-loading-text":"给我一点时间",border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{type:"index",label:"序号",align:"center",width:"50"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"职位名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.roleName))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"职位描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.row.roleDesc))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("parseTime")(t.row.createTime,"{y}-{m}-{d}")))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(i){e.handleUpdate(t.row)}}},[e._v("编辑\n              ")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){e.handleDelete(t.row)}}},[e._v("删除\n              ")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"info",plain:""},on:{click:function(i){e.handlePermission(t.row,"menuPermission")}}},[e._v("菜单\n               ")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"info",plain:""},on:{click:function(i){e.handlePermission(t.row,"dataPermission")}}},[e._v("权限\n              ")])]}}])})],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container",staticStyle:{"margin-top":"20px"}},[i("el-pagination",{staticStyle:{float:"left"},attrs:{"current-page":e.listQuery.page,background:"","page-sizes":[10,20,30,50],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.listQuery,"page",t)}}}),e._v(" "),i("div",{staticStyle:{float:"right"}},[e.permissions.upms_role_add?i("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.createClick()}}},[e._v("添加")]):e._e()],1)],1)],1)],1)],1),e._v(" "),i("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],width:"550px",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"所属部门",prop:"roleName"}},[i("tree-select",{attrs:{url:"/upms/org/tree"},model:{value:e.form.orgId,callback:function(t){e.$set(e.form,"orgId",t)},expression:"form.orgId"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[i("el-input",{attrs:{placeholder:"角色名称"},model:{value:e.form.roleName,callback:function(t){e.$set(e.form,"roleName",t)},expression:"form.roleName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"描述",prop:"roleDesc"}},[i("el-input",{attrs:{placeholder:"描述"},model:{value:e.form.roleDesc,callback:function(t){e.$set(e.form,"roleDesc",t)},expression:"form.roleDesc"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.cancel("form")}}},[i("i",{staticClass:"el-icon-fa-undo"}),e._v(" 取 消")]),e._v(" "),"create"==e.dialogStatus?i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.create("form")}}},[e._v("确 定")]):e._e(),e._v(" "),e.permissions.upms_role_update?i("el-button",{directives:[{name:"else",rawName:"v-else"}],attrs:{type:"primary"},on:{click:function(t){e.update("form")}}},[e._v("修 改")]):e._e()],1)],1),e._v(" "),i("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogPermissionVisible,width:"450px"},on:{"update:visible":function(t){e.dialogPermissionVisible=t},close:e.closePermission}},["menuPermission"===e.activeName?i("div",{staticStyle:{height:"450px",overflow:"auto"}},[e.menuUrl?i("my-tree",{attrs:{url:e.menuUrl,checkbox:!0},model:{value:e.permission.menuList,callback:function(t){e.$set(e.permission,"menuList",t)},expression:"permission.menuList"}}):e._e()],1):e._e(),e._v(" "),"dataPermission"===e.activeName?i("div",{staticStyle:{height:"450px",overflow:"auto"}},[e.dataUrl?i("my-tree",{attrs:{url:e.dataUrl,checkbox:!0},model:{value:e.permission.dataList,callback:function(t){e.$set(e.permission,"dataList",t)},expression:"permission.dataList"}}):e._e()],1):e._e(),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.updatePermession(e.roleId,e.roleKey)}}},[e._v("更 新")])],1)])],1)},r=[],a={render:o,staticRenderFns:r};t.a=a},"5Qg2":function(e,t,i){"use strict";function o(){return Object(d.a)({url:"/upms/role/roleList",method:"get"})}function r(e){return Object(d.a)({url:"/upms/role/rolePage",method:"get",params:e})}function a(e){return Object(d.a)({url:"/upms/role/"+e,method:"get"})}function s(e){return Object(d.a)({url:"/upms/role",method:"post",data:e})}function l(e){return Object(d.a)({url:"/upms/role",method:"put",data:e})}function n(e){return Object(d.a)({url:"/upms/role/"+e,method:"delete"})}function c(e,t){return Object(d.a)({url:"/upms/role/roleMenuUpd",method:"put",params:{roleId:e,menuIds:t}})}function u(e,t){return Object(d.a)({url:"/upms/role/roleOrgUpd",method:"put",params:{roleId:e,orgIds:t}})}t.h=o,t.d=r,t.e=a,t.a=s,t.g=l,t.c=n,t.f=c,t.b=u;var d=i("vLgD")},SpN4:function(e,t,i){"use strict";var o=i("Dd8w"),r=i.n(o),a=i("5Qg2"),s=i("NYxO"),l=i("E4LH");t.a={name:"table_role",data:function(){return{change:1,activeName:"menuPermission",treeData:[],checkedKeys:[],defaultProps:{children:"children",label:"name"},list:null,total:null,listLoading:!0,listQuery:{page:1,limit:20,roleName:null},form:{orgId:void 0,roleName:void 0,roleKey:void 0,roleDesc:void 0},permission:{menuList:[],dataList:[]},menuUrl:void 0,dataUrl:void 0,permissionState:1,roleId:void 0,roleKey:void 0,rules:{roleName:[{required:!0,message:"角色名称",trigger:["blur","change"]},{min:1,max:20,message:"长度在 3 到 20 个字符",trigger:["blur","change"]}]},statusOptions:["0","1"],rolesOptions:void 0,dialogFormVisible:!1,dialogPermissionVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"创建",permission:"分配权限"},tableKey:0}},created:function(){this.getList()},computed:r()({},Object(s.b)(["permissions","client"])),methods:{getList:function(){var e=this;this.listLoading=!0,this.listQuery.roleName=Object(l.a)(this.listQuery.roleName),Object(a.d)(this.listQuery).then(function(t){e.list=t.data.data.list,e.total=t.data.data.totalCount,e.listLoading=!1})},handleSizeChange:function(e){this.listQuery.limit=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()},createClick:function(){this.resetTemp(),this.change=2,this.dialogStatus="create",this.dialogFormVisible=!0},closePermission:function(){this.menuUrl="",this.dataUrl=""},handleUpdate:function(e){var t=this;Object(a.e)(e.roleId).then(function(e){t.form=e.data.data,t.change=2,t.dialogFormVisible=!0,t.dialogStatus="update"})},searchClick:function(){this.listQuery.page=1,this.getList()},handlePermission:function(e,t){this.activeName=t,this.dialogStatus="permission",this.dialogPermissionVisible=!0,this.roleId=e.roleId,this.menuUrl="/upms/menu/tree?roleId="+e.roleId,this.dataUrl="/upms/org/tree?roleId="+e.roleId,this.roleKey=e.roleKey},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},getNodeData:function(e){},handleDelete:function(e){var t=this;Object(a.c)(e.roleId).then(function(e){t.dialogFormVisible=!1,t.getList()})},create:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;Object(a.a)(t.form).then(function(){t.dialogFormVisible=!1,t.getList()})})},cancel:function(e){this.change=1,this.dialogFormVisible=!1,this.$refs[e].resetFields()},update:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.dialogFormVisible=!1,t.form.password=void 0,Object(a.g)(t.form).then(function(){t.dialogFormVisible=!1,t.getList()})})},updatePermession:function(e,t){var i=this;"menuPermission"===this.activeName&&Object(a.f)(e,this.permission.menuList).then(function(){i.dialogPermissionVisible=!1}),"dataPermission"===this.activeName&&Object(a.b)(e,this.permission.dataList).then(function(){i.dialogPermissionVisible=!1})},resetTemp:function(){this.form={id:void 0,roleName:void 0,roleKey:void 0,roleDesc:void 0}}}}},cbr0:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("SpN4"),r=i("+4gK"),a=i("VU/8"),s=a(o.a,r.a,!1,null,null,null);t.default=s.exports}});
//# sourceMappingURL=37.e2b8d9d2177d32e4aec8.js.map